{% extends "inventory/base.html" %}

{% block title %}Process Return - {{ return_obj.return_no }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2><i class="bi bi-gear"></i> Process Return: {{ return_obj.return_no }}</h2>
    
    <hr>
    
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="alert alert-info">
                <h6>Return Summary</h6>
                <ul class="mb-0">
                    <li><strong>Item:</strong> {{ return_obj.order_item.item.sku }} - {{ return_obj.order_item.item.name }}</li>
                    <li><strong>Quantity:</strong> {{ return_obj.qty_returned }} {{ return_obj.order_item.item.unit }}</li>
                    <li><strong>Reason:</strong> {{ return_obj.get_reason_display }}</li>
                    <li><strong>Order:</strong> {{ return_obj.order_item.order.order_no }} ({{ return_obj.order_item.order.customer_name }})</li>
                </ul>
            </div>
        </div>
    </div>
    
    <form method="post" hx-post="{% url 'inventory:return-process' return_obj.id %}" hx-target="#process-result">
        {% csrf_token %}
        <input type="hidden" name="return_id" value="{{ return_obj.id }}">
        
        <div class="row mb-3">
            <div class="col-md-6">
                <label for="{{ form.disposition.id_for_label }}" class="form-label">Disposition <span class="text-danger">*</span></label>
                {{ form.disposition }}
                {% if form.disposition.errors %}
                    <div class="text-danger">{{ form.disposition.errors }}</div>
                {% endif %}
                <small class="text-muted">Choose how to handle the returned items</small>
            </div>
            <div class="col-md-6">
                <label for="{{ form.qty_accepted.id_for_label }}" class="form-label">Quantity Accepted <span class="text-danger">*</span></label>
                {{ form.qty_accepted }}
                {% if form.qty_accepted.errors %}
                    <div class="text-danger">{{ form.qty_accepted.errors }}</div>
                {% endif %}
            </div>
        </div>
        
        <div class="row mb-3">
            <div class="col-md-12">
                <label for="{{ form.notes.id_for_label }}" class="form-label">Processing Notes</label>
                {{ form.notes }}
                {% if form.notes.errors %}
                    <div class="text-danger">{{ form.notes.errors }}</div>
                {% endif %}
            </div>
        </div>
        
        <div class="mt-3">
            <button type="submit" class="btn btn-primary">
                <i class="bi bi-check-circle"></i> Process Return
            </button>
            <a href="{% url 'inventory:return-detail' return_obj.pk %}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
    
    <div id="process-result" class="mt-4"></div>
</div>

<style>
    select, input[type="number"], textarea {
        width: 100%;
        padding: 0.375rem 0.75rem;
        border: 1px solid #ced4da;
        border-radius: 0.25rem;
    }
</style>
{% endblock %}
